// The interesting part becomes using promises with node:

// user-service.js

var Q = require("q")
var levelup = require("levelup")

var db = levelup("./mydb", {db: require("memdown"), valueEncoding: "json"})

module.exports.getUser = function () {
  var deferred = Q.defer()

  db.get("user", function (er, user) {
    if (er) return deferred.reject(er)
    deferred.resolve(user)
  })

  return deferred.promise
}

// --- OR ---

//module.exports.getUser = Q.nbind(db.get, db, "user")
module.exports.setUser = Q.nbind(db.put, db, "user")
